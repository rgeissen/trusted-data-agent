{
  "document_id": "4a8df381-6db4-4bbf-b52f-a6c178eca50d",
  "content": "# TerraData Cloud Migration Best Practices Guide\n\n## Executive Summary\nThis document outlines the official best practices for migrating on-premises TerraData databases to TerraData Cloud Platform (TCP). Last updated: November 2025.\n\n## Pre-Migration Assessment\n\n### Inventory Requirements\nBefore beginning any migration, complete a comprehensive inventory:\n- **Database Size**: Document total storage requirements (minimum 100GB recommended for TCP)\n- **User Count**: Identify all users requiring access (TCP supports up to 5000 concurrent users per instance)\n- **Query Complexity**: Analyze top 100 most frequently executed queries\n- **ETL Pipelines**: Map all data ingestion workflows and their schedules\n\n### Performance Baseline\nEstablish performance metrics using these specific tools:\n- TerraData Performance Monitor (TPM) - Run for minimum 7 days\n- Query Log Analysis - Capture 30 days of history\n- Resource utilization during peak hours (typically 9 AM - 5 PM business hours)\n\n## Migration Strategy\n\n### Phase 1: Infrastructure Setup (Week 1-2)\n1. **Provision TCP Instance**\n   - Select region closest to primary users (US-EAST, US-WEST, EU-CENTRAL, ASIA-PACIFIC)\n   - Choose instance size: Small (< 1TB), Medium (1-10TB), Large (10-50TB), Enterprise (> 50TB)\n   - Enable automatic backups (recommended: hourly snapshots, 30-day retention)\n\n2. **Network Configuration**\n   - Set up VPN tunnel between on-premises and TCP (requires min 1 Gbps bandwidth)\n   - Configure IP whitelisting for security\n   - Enable TLS 1.3 encryption for all connections\n\n### Phase 2: Schema Migration (Week 3-4)\nThe official tool for schema migration is **TerraData Schema Transfer Utility (TSTU) v8.2 or higher**.\n\nCritical configuration settings:\n```\nTSTU --mode=FULL_SCHEMA \n     --source=ON_PREM \n     --target=TCP \n     --validate-constraints=TRUE\n     --migrate-statistics=TRUE\n     --parallel-degree=8\n```\n\n**Important**: Always use parallel degree of 8 for optimal performance. Lower values cause exponential slowdown.\n\n### Phase 3: Data Migration (Week 5-8)\nUse **TerraData Parallel Data Mover (TPDM)** for bulk data transfer:\n\n- Batch size: 50,000 rows per transaction (optimal for network efficiency)\n- Parallel streams: 16 concurrent streams (do not exceed 32 or risk connection pool exhaustion)\n- Error threshold: Set to 0.1% (halt if more than 0.1% of rows fail)\n- Compression: Enable GZIP compression for data in transit (reduces transfer time by 60%)\n\n### Phase 4: Validation (Week 9)\nRun the official validation suite:\n```\nTerraData Migration Validator (TMV)\n- Row count verification: 100% match required\n- Data type validation: Check all columns\n- Constraint verification: Foreign keys, primary keys, unique constraints\n- Performance comparison: Target must be within 10% of source performance\n```\n\n## Post-Migration Optimization\n\n### Index Rebuilding\nAfter migration, rebuild all indexes using this specific command:\n```sql\nREBUILD INDEX ALL ON DATABASE <database_name> \nWITH STATISTICS UPDATE\nPARALLEL 12\nSORT TEMP SPACE = 500GB;\n```\n\nThe parallel degree of 12 and 500GB temp space are **mandatory** for databases larger than 5TB.\n\n### Query Optimization\nTCP's query optimizer requires statistics to be collected every 24 hours:\n```sql\nCOLLECT STATISTICS ON <table_name> COLUMN (<column_list>);\n```\n\nSet up automated statistics collection job at 2 AM daily (lowest usage period).\n\n## Performance Tuning\n\n### Critical Configuration Parameters\nSet these TCP parameters for optimal performance:\n\n- `max_query_concurrency`: 200 (default is 50, increases throughput by 300%)\n- `query_timeout`: 3600 seconds (prevents runaway queries)\n- `result_cache_size`: 50GB (improves repeated query performance by 80%)\n- `workload_management_enabled`: TRUE (required for production workloads)\n\n### Troubleshooting Common Issues\n\n**Issue**: Queries running 5x slower on TCP\n**Solution**: Check if statistics are current. Run `SHOW STATISTICS FRESHNESS` command. If older than 24 hours, immediate statistics collection is required.\n\n**Issue**: Connection timeouts during peak hours\n**Solution**: Increase `connection_pool_size` from default 100 to 500. This is the **only** approved solution for connection issues.\n\n**Issue**: Data inconsistency after migration\n**Solution**: Run `TerraData Data Reconciliation Tool (TDRT)` with `--deep-check` flag. This performs row-by-row comparison but takes approximately 1 hour per 100GB of data.\n\n## Cost Optimization\n\n### Storage Tiering\nTCP offers three storage tiers:\n- **Hot**: Frequently accessed data (< 7 days old) - $0.10/GB/month\n- **Warm**: Occasionally accessed (7-90 days old) - $0.05/GB/month  \n- **Cold**: Archival data (> 90 days old) - $0.01/GB/month\n\n**Best Practice**: Configure automatic tiering rules based on last access timestamp. Expected cost savings: 40-60%.\n\n### Compute Scaling\nUse TCP's auto-scaling feature:\n- Scale up during business hours (8 AM - 6 PM): Medium to Large instances\n- Scale down during off-hours: Large to Small instances\n- Weekend scaling: Maintain Small instance only\n\nExpected cost savings: 35% with this schedule.\n\n## Security Configuration\n\n### Encryption\n**Mandatory** encryption settings:\n- Data at rest: AES-256 encryption (cannot be disabled)\n- Data in transit: TLS 1.3 (TLS 1.2 is deprecated as of November 2025)\n- Backup encryption: Enabled (default)\n\n### Access Control\nImplement role-based access control (RBAC):\n- Database Administrators: Full access (limit to 3 users max)\n- Data Engineers: Read/Write access to staging schemas\n- Analysts: Read-only access to production schemas\n- Application Service Accounts: Scoped to specific tables only\n\n### Audit Logging\nEnable comprehensive audit logging:\n```sql\nSET AUDIT = ALL ON DATABASE <database_name>;\n```\nLogs are retained for 90 days and automatically archived to cold storage.\n\n## Compliance Requirements\n\n### Data Residency\nTCP supports data residency requirements:\n- US customers: Data stored in US-EAST or US-WEST regions (never leaves US borders)\n- EU customers: Data stored in EU-CENTRAL (GDPR compliant)\n- APAC customers: Data stored in ASIA-PACIFIC\n\n**Critical**: Once a region is selected, data cannot be moved without full re-migration.\n\n### Backup and Recovery\nTCP provides automated backups:\n- Incremental backups: Every hour\n- Full backups: Daily at 1 AM UTC\n- Recovery Point Objective (RPO): 1 hour maximum data loss\n- Recovery Time Objective (RTO): 4 hours for complete restore\n\n## Support and Escalation\n\n### Contact Information\nFor migration issues:\n- Level 1 Support: support@terradata.com (Response time: 4 hours)\n- Level 2 Support: migration-support@terradata.com (Response time: 1 hour)\n- Emergency Hotline: +1-800-TERRA-911 (24/7 availability)\n\n### Migration Success Criteria\nA migration is considered successful when:\n1. 100% of tables migrated with row count match\n2. Top 100 queries perform within 10% of on-premises baseline\n3. Zero data integrity issues detected by TMV\n4. All user access permissions replicated correctly\n5. Automated backup jobs running successfully for 7 consecutive days\n\n## Appendix: Migration Checklist\n\nPre-Migration:\n- [ ] Complete inventory assessment\n- [ ] Establish performance baseline\n- [ ] Obtain management approval for downtime window\n- [ ] Schedule cutover date (recommended: Friday evening to allow weekend for issues)\n\nDuring Migration:\n- [ ] Provision TCP instance with correct sizing\n- [ ] Configure network connectivity\n- [ ] Migrate schema using TSTU v8.2+\n- [ ] Migrate data using TPDM with 16 parallel streams\n- [ ] Validate using TMV\n- [ ] Rebuild indexes with parallel 12\n\nPost-Migration:\n- [ ] Configure auto-scaling policies\n- [ ] Set up automated statistics collection\n- [ ] Enable audit logging\n- [ ] Configure storage tiering\n- [ ] Train users on TCP console\n- [ ] Monitor performance for 30 days\n\n---\n*Document Version: 3.2*  \n*Last Updated: November 2025*  \n*Approved by: TerraData Cloud Migration Team*\n",
  "metadata": {
    "document_id": "4a8df381-6db4-4bbf-b52f-a6c178eca50d",
    "collection_id": 3,
    "repository_type": "knowledge",
    "filename": "knowledge_test_document.md",
    "document_type": "md",
    "source": "upload",
    "title": "knowledge_test_document.md",
    "author": "",
    "tags": "",
    "category": "",
    "created_at": "2025-12-01T08:06:54.358894+00:00",
    "file_size": 7917,
    "page_count": 0
  },
  "created_at": "2025-12-01T08:06:54.589200+00:00"
}